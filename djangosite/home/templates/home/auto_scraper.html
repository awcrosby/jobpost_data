{% extends 'home/base.html' %}
{% block content %}

{% load my_filters %}

<div style="margin: 20px 0px 10px 0px; font-weight: bold;">Auto Scraper</div>

<div id="active_tasks">
    <h3>Active Tasks</h3>
    {{ active }}
    {% if active %}
    <p>Task name and arguments:</p>
      <ul>{% for task in active %}<li>{{ task.name }} - {{ task.args }} {{ task.kwargs }}</li>{% endfor %}</ul>
    {% else %}
      <p>None</p>
    {% endif %}
</div>

<div id="queue_tasks">
    <h3>Tasks in Queue</h3>
    {% if queue %}
    <p>Task name and arguments:</p>
      <ul>{% for task in queue %}<li>{{ task.name }} - {{ task.args }} {{ task.kwargs }}</li>{% endfor %}</ul>
    {% else %}
      <p>None</p>
    {% endif %}
</div>

<div id="all_db_tasks">
  <h3>All Auto-Running Tasks (via Celery Beat PeriodicTasks Table)</h3>
  <table>
    <tr>
      <th>Base Task</th>
      <th>Args</th>
      <th>Day / Crontab_Id</th>
      <th>Last Run</th>
    </tr>
    {% for task in tasks %}<tr>
      <td>{{ task.task }}</td>
      <td>{{ task.args }}</td>
      <td>{{ task.crontab_id }}</td>
      <td>{{ task.last_run_at }}</td>
    {% endfor %}
    
  </table>
</div>

{% endblock %}
